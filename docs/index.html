<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2019-10-06 Sun 18:39 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Rogue-Like Game in C++17</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Neel Raiyani">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="note-style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">Rogue-Like Game in C++17</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd1e40c2">1. Setup</a></li>
<li><a href="#orgb666c50">2. Drawing Player and Moving around</a></li>
<li><a href="#org6b62a27">3. Entity System</a></li>
<li><a href="#org1220c32">4. Generating a Dungeon</a></li>
<li><a href="#orge70f153">5. Field of View</a></li>
<li><a href="#orga2c2730">6. Placing Enemies</a></li>
<li><a href="#org7470330">7. Combat Loop</a></li>
<li><a href="#org15f413d">8. User Interface</a></li>
<li><a href="#orgecbdb0c">9. Items and Inventory</a></li>
<li><a href="#org3096f66">10. Equiping Items</a></li>
<li><a href="#orgb73de70">11. Weapons and Targetting</a></li>
<li><a href="#org70303da">12. Saving and Loading Game State</a></li>
<li><a href="#orgb5339ee">13. Dungeon Delving</a></li>
<li><a href="#org8b9ba59">14. Difficulty Curve</a></li>
</ul>
</div>
</nav>
<p>
This file documents my attempts at going through a process of making a Rogue-Like game.<br>
The associated source code lives in <a href="https://github.com/Roy-Fokker/roguelike">GitHub Repo</a>.<br>
</p>

<p>
It's written in sort of literal programming format. Documentation is written in Emacs Org-Mode and exported to html which used by github to display this page. As emacs is not being used for any code related purposes, rest of this document ignores this aspect.<br>
</p>

<div id="outline-container-orgd1e40c2" class="outline-2">
<h2 id="orgd1e40c2"><span class="section-number-2">1</span> Setup</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgfdcb1ef" class="outline-3">
<h3 id="orgfdcb1ef"><span class="section-number-3">1.1</span> Environment Setup</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-orgf90bdda" class="outline-4">
<h4 id="orgf90bdda"><span class="section-number-4">1.1.1</span> Tools of the trade:</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
Below is listing of tools I am using<br>
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-right">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Tool</th>
<th scope="col" class="org-left">Name</th>
<th scope="col" class="org-right">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Editor</td>
<td class="org-left"><a href="https://code.visualstudio.com/">VSCode</a></td>
<td class="org-right">1.38.1</td>
</tr>

<tr>
<td class="org-left">C++ Toolchain</td>
<td class="org-left"><a href="https://visualstudio.microsoft.com/vs/">Visual Studio 2019 Community</a></td>
<td class="org-right">16.3.2</td>
</tr>

<tr>
<td class="org-left">C++ Build Generator</td>
<td class="org-left"><a href="https://cmake.org/">CMake</a></td>
<td class="org-right">3.15.1</td>
</tr>

<tr>
<td class="org-left">C++ Package Manager</td>
<td class="org-left"><a href="https://github.com/Microsoft/vcpkg">vcpkg</a></td>
<td class="org-right">2019.09</td>
</tr>

<tr>
<td class="org-left">Version Control</td>
<td class="org-left"><a href="https://git-scm.com/">git</a></td>
<td class="org-right">2.23.0</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org10da952" class="outline-4">
<h4 id="org10da952"><span class="section-number-4">1.1.2</span> Editor Configuration</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
Following extensions are installed in VSCode<br>
</p>
<ul class="org-ul">
<li><a href="https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer-2">Bracket Pair Colorizer 2</a><br></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools">C/C++</a><br></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=maddouri.cmake-tools-helper">CMake Tools Helper</a><br>
This will installed 2 other extensions<br>
<ul class="org-ul">
<li><a href="https://marketplace.visualstudio.com/items?itemName=vector-of-bool.cmake-tools">CMake Tools</a><br></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=twxs.cmake">CMake for Visual Studio Code</a><br></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org37bc1a0" class="outline-4">
<h4 id="org37bc1a0"><span class="section-number-4">1.1.3</span> vcpkg configuration</h4>
<div class="outline-text-4" id="text-1-1-3">
<ul class="org-ul">
<li>Add Environment Variable called VCPKG_ROOT and point it to location of your vcpkg installation directory.<br>
For me this is 'D:\Projects\CPP\.packages\vcpkg'.<br></li>
<li>Add Environment Variable called VCPKG_DEFAULT_TRIPLET and set it equal to x64-&lt;system name&gt;.<br>
Again for me this is 'x64-Windows'.<br></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org7044789" class="outline-3">
<h3 id="org7044789"><span class="section-number-3">1.2</span> Project Setup</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org450d574" class="outline-4">
<h4 id="org450d574"><span class="section-number-4">1.2.1</span> Folder Structure</h4>
<div class="outline-text-4" id="text-1-2-1">
<pre class="example">
\          # Root folder
\build\    # where cmake will put all build generated files
\docs\     # documentation folder, where this index.html file is located
\src\      # where all the source files will go
\external\ # any 3rd party libraries we can't get via vcpkg will go here
</pre>
</div>
</div>
<div id="outline-container-org45fdd98" class="outline-4">
<h4 id="org45fdd98"><span class="section-number-4">1.2.2</span> <code>\.gitignore</code> file</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
We'll be ignore following files and folders. No point in adding these to our git repo.<br>
</p>
<div class="org-src-container">
<pre class="src src-markdown"><span class="linenr"> 1: </span><span style="color: #b3b3b3;"># </span><span style="color: #50fa7b; font-weight: bold;">cmake build directory</span>
<span class="linenr"> 2: </span>build/
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #b3b3b3;"># </span><span style="color: #50fa7b; font-weight: bold;">vscode and visual studio specific</span>
<span class="linenr"> 5: </span>.vscode/
<span class="linenr"> 6: </span>.vs/
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span><span style="color: #b3b3b3;"># </span><span style="color: #50fa7b; font-weight: bold;">org-mode temp files</span>
<span class="linenr"> 9: </span>./*.html
<span class="linenr">10: </span>backups/
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf54098d" class="outline-4">
<h4 id="orgf54098d"><span class="section-number-4">1.2.3</span> CMake configuration</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
After you create the CMakeList.txt file below, VSCode should recognize this folder as being CMake project.<br>
It will ask you to choose the toolchain with which to envoke the build process.<br>
</p>

<ul class="org-ul">
<li><p>
<code>\CMakeLists.txt</code><br>
This in the root of our project. We define basic things about how cmake should do things.<br>
Lines 3 to 6 tell cmake to use vcpkg toolchain file.<br>
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span class="linenr"> 1: </span><span style="color: #50fa7b; font-weight: bold;">cmake_minimum_required</span><span style="color: #f8f8f2;">(</span>VERSION 3.15.0<span style="color: #f8f8f2;">)</span>
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #ff79c6; font-weight: bold;">if</span><span style="color: #f8f8f2;">(</span>DEFINED ENV<span style="color: #8be9fd;">{</span>VCPKG_ROOT<span style="color: #8be9fd;">}</span> AND NOT DEFINED CMAKE_TOOLCHAIN_FILE<span style="color: #f8f8f2;">)</span>
<span class="linenr"> 4: </span>  <span style="color: #50fa7b; font-weight: bold;">set</span><span style="color: #f8f8f2;">(</span>CMAKE_TOOLCHAIN_FILE <span style="color: #f1fa8c;">"$ENV{VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake"</span>
<span class="linenr"> 5: </span>      CACHE STRING <span style="color: #f1fa8c;">""</span><span style="color: #f8f8f2;">)</span>
<span class="linenr"> 6: </span><span style="color: #ff79c6; font-weight: bold;">endif</span><span style="color: #f8f8f2;">()</span>
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span><span style="color: #50fa7b; font-weight: bold;">project</span><span style="color: #f8f8f2;">(</span>rogue
<span class="linenr"> 9: </span>        LANGUAGES CXX 
<span class="linenr">10: </span>        VERSION 0.1.0<span style="color: #f8f8f2;">)</span>
<span class="linenr">11: </span>
<span class="linenr">12: </span><span style="color: #50fa7b; font-weight: bold;">set</span><span style="color: #f8f8f2;">(</span>CMAKE_CXX_STANDARD_REQUIRED ON<span style="color: #f8f8f2;">)</span>
<span class="linenr">13: </span>
<span class="linenr">14: </span><span style="color: #50fa7b; font-weight: bold;">add_subdirectory</span><span style="color: #f8f8f2;">(</span>src<span style="color: #f8f8f2;">)</span>
<span class="linenr">15: </span>
</pre>
</div></li>
<li><p>
<code>\src\CMakeLists.txt</code><br>
This is in our src directory, here we tell cmake that we want output executable to be named rogue.exe.<br>
We also tell it we want to use C++17 standard. This doesn't actually work with MSVC.<br>
So&#x2026; we have to explictly tell cmake to pass some parameters to MSVC compiler<br>
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span class="linenr"> 1: </span><span style="color: #50fa7b; font-weight: bold;">add_executable</span><span style="color: #f8f8f2;">(</span>rogue main.cpp<span style="color: #f8f8f2;">)</span>
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #50fa7b; font-weight: bold;">target_compile_features</span><span style="color: #f8f8f2;">(</span>rogue PRIVATE cxx_std_17<span style="color: #f8f8f2;">)</span>
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span><span style="color: #50fa7b; font-weight: bold;">target_compile_options</span><span style="color: #f8f8f2;">(</span>rogue
<span class="linenr"> 6: </span>                       PRIVATE 
<span class="linenr"> 7: </span>                       $&lt;$&lt;CXX_COMPILER_ID:MSVC&gt;:/W3 /permissive- /Zc:__cplusplus /std:c++17&gt;<span style="color: #f8f8f2;">)</span>
<span class="linenr"> 8: </span>
<span class="linenr"> 9: </span><span style="color: #50fa7b; font-weight: bold;">target_compile_definitions</span><span style="color: #f8f8f2;">(</span>rogue
<span class="linenr">10: </span>                           PRIVATE
<span class="linenr">11: </span>                           $&lt;$&lt;CONFIG:Debug&gt;:DEBUG _DEBUG&gt;<span style="color: #f8f8f2;">)</span>
<span class="linenr">12: </span>
<span class="linenr">13: </span><span style="color: #50fa7b; font-weight: bold;">find_package</span><span style="color: #f8f8f2;">(</span>fmt REQUIRED<span style="color: #f8f8f2;">)</span>
<span class="linenr">14: </span><span style="color: #50fa7b; font-weight: bold;">target_link_libraries</span><span style="color: #f8f8f2;">(</span>rogue PRIVATE fmt::fmt<span style="color: #f8f8f2;">)</span>
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orgf6ab2d7" class="outline-4">
<h4 id="orgf6ab2d7"><span class="section-number-4">1.2.4</span> Hello World test file</h4>
<div class="outline-text-4" id="text-1-2-4">
<p>
Time to test if the Setup is done properly.<br>
Let's create <code>\src\main.cpp</code> file<br>
</p>
<div class="org-src-container">
<pre class="src src-cpp"><span class="linenr"> 1: </span><span style="color: #ffb86c;">#include</span> <span style="color: #f8f8f2;">&lt;</span><span style="color: #f1fa8c;">iostream</span><span style="color: #f8f8f2;">&gt;</span>
<span class="linenr"> 2: </span><span style="color: #ffb86c;">#include</span> <span style="color: #f8f8f2;">&lt;</span><span style="color: #f1fa8c;">fmt/core.h</span><span style="color: #f8f8f2;">&gt;</span>
<span class="linenr"> 3: </span><span style="color: #ffb86c;">#include</span> <span style="color: #f8f8f2;">&lt;</span><span style="color: #f1fa8c;">chrono</span><span style="color: #f8f8f2;">&gt;</span>
<span class="linenr"> 4: </span><span style="color: #ffb86c;">#include</span> <span style="color: #f8f8f2;">&lt;</span><span style="color: #f1fa8c;">string</span><span style="color: #f8f8f2;">&gt;</span>
<span class="linenr"> 5: </span>
<span class="linenr"> 6: </span><span style="color: #bd93f9;">int</span> <span style="color: #50fa7b; font-weight: bold;">main</span><span style="color: #f8f8f2;">()</span>
<span class="linenr"> 7: </span><span style="color: #f8f8f2;">{</span>
<span class="linenr"> 8: </span>    <span style="color: #ff79c6; font-weight: bold;">auto</span> <span style="color: #f8f8f2;">tp</span> = <span style="color: #8be9fd;">std</span>::<span style="color: #8be9fd;">chrono</span>::<span style="color: #8be9fd;">system_clock</span>::now<span style="color: #8be9fd;">()</span>;
<span class="linenr"> 9: </span>    <span style="color: #ff79c6; font-weight: bold;">auto</span> <span style="color: #f8f8f2;">now_c</span> = <span style="color: #8be9fd;">std</span>::<span style="color: #8be9fd;">chrono</span>::<span style="color: #8be9fd;">system_clock</span>::to_time_t<span style="color: #8be9fd;">(</span>tp<span style="color: #8be9fd;">)</span>;
<span class="linenr">10: </span>    <span style="color: #8be9fd;">fmt</span>::print<span style="color: #8be9fd;">(</span><span style="color: #f1fa8c;">"Hello, World! {}"</span>, now_c<span style="color: #8be9fd;">)</span>;
<span class="linenr">11: </span><span style="color: #f8f8f2;">}</span>
</pre>
</div>

<p>
If you tried to build the project now you'll find that cmake can't find <code>fmt</code> library.<br>
So we need to get vcpkg to download this libary.<br>
</p>
<div class="org-src-container">
<pre class="src src-bat"><span class="linenr">1: </span>vcpkg install fmt
</pre>
</div>
<p>
After vcpkg completes downloading and building <code>fmt</code> we can get vscode to run the build command.<br>
</p>

<p>
If all of the above is done properly the file below should compile and generate an executable.<br>
It can be executed by calling <code>\build\src\rogue.exe</code> from the project root folder.<br>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb666c50" class="outline-2">
<h2 id="orgb666c50"><span class="section-number-2">2</span> Drawing Player and Moving around</h2>
</div>

<div id="outline-container-org6b62a27" class="outline-2">
<h2 id="org6b62a27"><span class="section-number-2">3</span> Entity System</h2>
</div>

<div id="outline-container-org1220c32" class="outline-2">
<h2 id="org1220c32"><span class="section-number-2">4</span> Generating a Dungeon</h2>
</div>

<div id="outline-container-orge70f153" class="outline-2">
<h2 id="orge70f153"><span class="section-number-2">5</span> Field of View</h2>
</div>

<div id="outline-container-orga2c2730" class="outline-2">
<h2 id="orga2c2730"><span class="section-number-2">6</span> Placing Enemies</h2>
</div>

<div id="outline-container-org7470330" class="outline-2">
<h2 id="org7470330"><span class="section-number-2">7</span> Combat Loop</h2>
</div>

<div id="outline-container-org15f413d" class="outline-2">
<h2 id="org15f413d"><span class="section-number-2">8</span> User Interface</h2>
</div>

<div id="outline-container-orgecbdb0c" class="outline-2">
<h2 id="orgecbdb0c"><span class="section-number-2">9</span> Items and Inventory</h2>
</div>

<div id="outline-container-org3096f66" class="outline-2">
<h2 id="org3096f66"><span class="section-number-2">10</span> Equiping Items</h2>
</div>

<div id="outline-container-orgb73de70" class="outline-2">
<h2 id="orgb73de70"><span class="section-number-2">11</span> Weapons and Targetting</h2>
</div>

<div id="outline-container-org70303da" class="outline-2">
<h2 id="org70303da"><span class="section-number-2">12</span> Saving and Loading Game State</h2>
</div>

<div id="outline-container-orgb5339ee" class="outline-2">
<h2 id="orgb5339ee"><span class="section-number-2">13</span> Dungeon Delving</h2>
</div>

<div id="outline-container-org8b9ba59" class="outline-2">
<h2 id="org8b9ba59"><span class="section-number-2">14</span> Difficulty Curve</h2>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Neel Raiyani</p>
<p class="date">Created: 2019-10-06 Sun 18:39</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
